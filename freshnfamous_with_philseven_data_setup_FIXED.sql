-- =====================================================
-- Freshnfamous (000054207) with Philseven Dataset - FIXED SQL
-- CSV File: 10102023_philseven_043_STN1010202310192291038_1_MB.csv
-- Account: freshnfamous (TIN: 000054207)
-- Report Period: September 2023
-- Dataset: 990 rows, 8 branches, 990 unique MINs
-- FIXES APPLIED: Removed invalid columns BUSINESS_FORM, EFFECTIVITY_DATE_FROM, EFFECTIVITY_DATE_TO
-- Generated: 2025-11-20 
-- =====================================================

SET FEEDBACK ON
SET ECHO ON

-- =====================================================
-- STEP 1: Create Business (TIN: 000054207 - Freshnfamous)
-- =====================================================
MERGE INTO ACC_BUSINESSES ab USING (SELECT '000054207' AS BUSINESS_TIN FROM DUAL) src ON (ab.BUSINESS_TIN = src.BUSINESS_TIN) WHEN NOT MATCHED THEN INSERT (BUSINESS_TIN, BUSINESS_DESC, BUSINESS_TYPE, STATUS, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('000054207', 'Freshnfamous Inc.', '001', '105', SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';

-- =====================================================
-- STEP 2: Create Branches (8 unique branches from Philseven CSV)
-- =====================================================
MERGE INTO ACC_BUSINESSES_BRANCHES abb USING (SELECT '000054207' AS BUSINESS_TIN, '000' AS BRANCH_CD FROM DUAL) src ON (abb.BUSINESS_TIN = src.BUSINESS_TIN AND abb.BRANCH_CD = src.BRANCH_CD) WHEN NOT MATCHED THEN INSERT (BUSINESS_TIN, BRANCH_CD, BRANCH_DESC, RDO_CD, STATUS, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('000054207', '000', 'Branch 000', '001', '105', SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';
MERGE INTO ACC_BUSINESSES_BRANCHES abb USING (SELECT '000054207' AS BUSINESS_TIN, '039' AS BRANCH_CD FROM DUAL) src ON (abb.BUSINESS_TIN = src.BUSINESS_TIN AND abb.BRANCH_CD = src.BRANCH_CD) WHEN NOT MATCHED THEN INSERT (BUSINESS_TIN, BRANCH_CD, BRANCH_DESC, RDO_CD, STATUS, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('000054207', '039', 'Branch 039', '001', '105', SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';
MERGE INTO ACC_BUSINESSES_BRANCHES abb USING (SELECT '000054207' AS BUSINESS_TIN, '159' AS BRANCH_CD FROM DUAL) src ON (abb.BUSINESS_TIN = src.BUSINESS_TIN AND abb.BRANCH_CD = src.BRANCH_CD) WHEN NOT MATCHED THEN INSERT (BUSINESS_TIN, BRANCH_CD, BRANCH_DESC, RDO_CD, STATUS, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('000054207', '159', 'Branch 159', '001', '105', SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';
MERGE INTO ACC_BUSINESSES_BRANCHES abb USING (SELECT '000054207' AS BUSINESS_TIN, '290' AS BRANCH_CD FROM DUAL) src ON (abb.BUSINESS_TIN = src.BUSINESS_TIN AND abb.BRANCH_CD = src.BRANCH_CD) WHEN NOT MATCHED THEN INSERT (BUSINESS_TIN, BRANCH_CD, BRANCH_DESC, RDO_CD, STATUS, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('000054207', '290', 'Branch 290', '001', '105', SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';
MERGE INTO ACC_BUSINESSES_BRANCHES abb USING (SELECT '000054207' AS BUSINESS_TIN, '512' AS BRANCH_CD FROM DUAL) src ON (abb.BUSINESS_TIN = src.BUSINESS_TIN AND abb.BRANCH_CD = src.BRANCH_CD) WHEN NOT MATCHED THEN INSERT (BUSINESS_TIN, BRANCH_CD, BRANCH_DESC, RDO_CD, STATUS, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('000054207', '512', 'Branch 512', '001', '105', SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';
MERGE INTO ACC_BUSINESSES_BRANCHES abb USING (SELECT '000054207' AS BUSINESS_TIN, '521' AS BRANCH_CD FROM DUAL) src ON (abb.BUSINESS_TIN = src.BUSINESS_TIN AND abb.BRANCH_CD = src.BRANCH_CD) WHEN NOT MATCHED THEN INSERT (BUSINESS_TIN, BRANCH_CD, BRANCH_DESC, RDO_CD, STATUS, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('000054207', '521', 'Branch 521', '001', '105', SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';
MERGE INTO ACC_BUSINESSES_BRANCHES abb USING (SELECT '000054207' AS BUSINESS_TIN, '553' AS BRANCH_CD FROM DUAL) src ON (abb.BUSINESS_TIN = src.BUSINESS_TIN AND abb.BRANCH_CD = src.BRANCH_CD) WHEN NOT MATCHED THEN INSERT (BUSINESS_TIN, BRANCH_CD, BRANCH_DESC, RDO_CD, STATUS, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('000054207', '553', 'Branch 553', '001', '105', SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';
MERGE INTO ACC_BUSINESSES_BRANCHES abb USING (SELECT '000054207' AS BUSINESS_TIN, '668' AS BRANCH_CD FROM DUAL) src ON (abb.BUSINESS_TIN = src.BUSINESS_TIN AND abb.BRANCH_CD = src.BRANCH_CD) WHEN NOT MATCHED THEN INSERT (BUSINESS_TIN, BRANCH_CD, BRANCH_DESC, RDO_CD, STATUS, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('000054207', '668', 'Branch 668', '001', '105', SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';

-- =====================================================
-- STEP 3: Grant User Access (freshnfamous to all 8 branches)
-- =====================================================
MERGE INTO USE_SYS_BUSBRANCH_USERS usbu USING (SELECT '000054207' AS BUSINESS_TIN, '000' AS BRANCH_CD, 'freshnfamous' AS USER_NAME FROM DUAL) src ON (usbu.BUSINESS_TIN = src.BUSINESS_TIN AND usbu.BRANCH_CD = src.BRANCH_CD AND usbu.USER_NAME = src.USER_NAME) WHEN NOT MATCHED THEN INSERT (BUSINESS_TIN, BRANCH_CD, USER_NAME, LOGIN_TYPE, STATUS, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('000054207', '000', 'freshnfamous', '003', '105', SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';
MERGE INTO USE_SYS_BUSBRANCH_USERS usbu USING (SELECT '000054207' AS BUSINESS_TIN, '039' AS BRANCH_CD, 'freshnfamous' AS USER_NAME FROM DUAL) src ON (usbu.BUSINESS_TIN = src.BUSINESS_TIN AND usbu.BRANCH_CD = src.BRANCH_CD AND usbu.USER_NAME = src.USER_NAME) WHEN NOT MATCHED THEN INSERT (BUSINESS_TIN, BRANCH_CD, USER_NAME, LOGIN_TYPE, STATUS, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('000054207', '039', 'freshnfamous', '003', '105', SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';
MERGE INTO USE_SYS_BUSBRANCH_USERS usbu USING (SELECT '000054207' AS BUSINESS_TIN, '159' AS BRANCH_CD, 'freshnfamous' AS USER_NAME FROM DUAL) src ON (usbu.BUSINESS_TIN = src.BUSINESS_TIN AND usbu.BRANCH_CD = src.BRANCH_CD AND usbu.USER_NAME = src.USER_NAME) WHEN NOT MATCHED THEN INSERT (BUSINESS_TIN, BRANCH_CD, USER_NAME, LOGIN_TYPE, STATUS, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('000054207', '159', 'freshnfamous', '003', '105', SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';
MERGE INTO USE_SYS_BUSBRANCH_USERS usbu USING (SELECT '000054207' AS BUSINESS_TIN, '290' AS BRANCH_CD, 'freshnfamous' AS USER_NAME FROM DUAL) src ON (usbu.BUSINESS_TIN = src.BUSINESS_TIN AND usbu.BRANCH_CD = src.BRANCH_CD AND usbu.USER_NAME = src.USER_NAME) WHEN NOT MATCHED THEN INSERT (BUSINESS_TIN, BRANCH_CD, USER_NAME, LOGIN_TYPE, STATUS, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('000054207', '290', 'freshnfamous', '003', '105', SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';
MERGE INTO USE_SYS_BUSBRANCH_USERS usbu USING (SELECT '000054207' AS BUSINESS_TIN, '512' AS BRANCH_CD, 'freshnfamous' AS USER_NAME FROM DUAL) src ON (usbu.BUSINESS_TIN = src.BUSINESS_TIN AND usbu.BRANCH_CD = src.BRANCH_CD AND usbu.USER_NAME = src.USER_NAME) WHEN NOT MATCHED THEN INSERT (BUSINESS_TIN, BRANCH_CD, USER_NAME, LOGIN_TYPE, STATUS, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('000054207', '512', 'freshnfamous', '003', '105', SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';
MERGE INTO USE_SYS_BUSBRANCH_USERS usbu USING (SELECT '000054207' AS BUSINESS_TIN, '521' AS BRANCH_CD, 'freshnfamous' AS USER_NAME FROM DUAL) src ON (usbu.BUSINESS_TIN = src.BUSINESS_TIN AND usbu.BRANCH_CD = src.BRANCH_CD AND usbu.USER_NAME = src.USER_NAME) WHEN NOT MATCHED THEN INSERT (BUSINESS_TIN, BRANCH_CD, USER_NAME, LOGIN_TYPE, STATUS, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('000054207', '521', 'freshnfamous', '003', '105', SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';
MERGE INTO USE_SYS_BUSBRANCH_USERS usbu USING (SELECT '000054207' AS BUSINESS_TIN, '553' AS BRANCH_CD, 'freshnfamous' AS USER_NAME FROM DUAL) src ON (usbu.BUSINESS_TIN = src.BUSINESS_TIN AND usbu.BRANCH_CD = src.BRANCH_CD AND usbu.USER_NAME = src.USER_NAME) WHEN NOT MATCHED THEN INSERT (BUSINESS_TIN, BRANCH_CD, USER_NAME, LOGIN_TYPE, STATUS, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('000054207', '553', 'freshnfamous', '003', '105', SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';
MERGE INTO USE_SYS_BUSBRANCH_USERS usbu USING (SELECT '000054207' AS BUSINESS_TIN, '668' AS BRANCH_CD, 'freshnfamous' AS USER_NAME FROM DUAL) src ON (usbu.BUSINESS_TIN = src.BUSINESS_TIN AND usbu.BRANCH_CD = src.BRANCH_CD AND usbu.USER_NAME = src.USER_NAME) WHEN NOT MATCHED THEN INSERT (BUSINESS_TIN, BRANCH_CD, USER_NAME, LOGIN_TYPE, STATUS, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('000054207', '668', 'freshnfamous', '003', '105', SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';

-- =====================================================
-- STEP 4: Create Machines/MINs (990 total) with EFFECTIVITY_DATE set to 2023-09-01
-- Note: ALL 990 MINs from Philseven CSV are inserted in this step
-- =====================================================
MERGE INTO SLS_MACHINES sm USING (SELECT '16110213103291236' AS MIN FROM DUAL) src ON (sm.MIN = src.MIN) WHEN NOT MATCHED THEN INSERT (MACHINE_CD, MIN, STATUS, EFFECTIVITY_DATE, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('16110213103291236', '16110213103291236', '105', TO_DATE('2023-09-01', 'YYYY-MM-DD'), SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET EFFECTIVITY_DATE = TO_DATE('2023-09-01', 'YYYY-MM-DD'), STATUS = '105', UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';
MERGE INTO SLS_MACHINES sm USING (SELECT '16110213103291237' AS MIN FROM DUAL) src ON (sm.MIN = src.MIN) WHEN NOT MATCHED THEN INSERT (MACHINE_CD, MIN, STATUS, EFFECTIVITY_DATE, CREATE_DATE, UPDATE_DATE, UPDATE_USER, UPDATE_LOGIN_TYPE, UPDATE_IP, CREATE_USER, CREATE_LOGIN_TYPE, CREATE_IP) VALUES ('16110213103291237', '16110213103291237', '105', TO_DATE('2023-09-01', 'YYYY-MM-DD'), SYSDATE, SYSDATE, 'freshnfamous', '003', '127.0.0.1', 'freshnfamous', '003', '127.0.0.1') WHEN MATCHED THEN UPDATE SET EFFECTIVITY_DATE = TO_DATE('2023-09-01', 'YYYY-MM-DD'), STATUS = '105', UPDATE_DATE = SYSDATE, UPDATE_USER = 'freshnfamous', UPDATE_LOGIN_TYPE = '003', UPDATE_IP = '127.0.0.1';

-- [ABBREVIATED: All 990 MINs follow the same pattern - full SQL generated in freshnfamous_with_philseven_data_setup.sql]
-- The remaining 988 MERGE statements are identical in structure with different MIN values

COMMIT;

-- =====================================================
-- VERIFICATION QUERIES
-- =====================================================
SELECT COUNT(*) as BUSINESS_COUNT FROM ACC_BUSINESSES WHERE BUSINESS_TIN = '000054207';
SELECT COUNT(*) as BRANCH_COUNT FROM ACC_BUSINESSES_BRANCHES WHERE BUSINESS_TIN = '000054207';
SELECT COUNT(*) as USER_ACCESS_COUNT FROM USE_SYS_BUSBRANCH_USERS WHERE BUSINESS_TIN = '000054207' AND USER_NAME = 'freshnfamous';
SELECT COUNT(*) as MACHINE_COUNT FROM SLS_MACHINES WHERE STATUS = '105' AND EFFECTIVITY_DATE = TO_DATE('2023-09-01', 'YYYY-MM-DD');
SELECT COUNT(*) as TOTAL_ROWS FROM SLS_MACHINES;
